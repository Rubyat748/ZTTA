<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ExoPlanet Atlas | JWST + NASA + Community</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    :root{
      --primary:#00d4ff;--secondary:#ff00aa;--dark:#0a0a1a;--light:#f0f8ff;
      --glow:0 0 20px rgba(0,212,255,.6);--transition:all .4s ease;
    }
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Inter',sans-serif;background:#000;color:var(--light);overflow-x:hidden;line-height:1.7;}
    .bg{position:fixed;top:0;left:0;width:100%;height:100%;background:url('assets/background.png') center/cover no-repeat;z-index:-2;filter:brightness(.7);}
    .overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,rgba(0,0,50,.8),rgba(10,0,30,.9));z-index:-1;}

    header{position:fixed;top:0;left:0;right:0;padding:1rem 5%;display:flex;justify-content:space-between;align-items:center;z-index:1000;backdrop-filter:blur(10px);background:rgba(0,0,0,.3);border-bottom:1px solid rgba(0,212,255,.2);}
    .logo{font-family:'Orbitron',sans-serif;font-size:1.8rem;font-weight:900;background:linear-gradient(90deg,var(--primary),var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    .time{font-size:0.9rem;color:#aaa;}

    nav a{color:#fff;margin:0 .8rem;font-weight:600;text-decoration:none;font-size:1rem;transition:var(--transition);position:relative;}
    nav a::after{content:'';position:absolute;width:0;height:2px;bottom:-6px;left:0;background:var(--primary);transition:width .3s;}
    nav a:hover::after{width:100%;}nav a:hover{color:var(--primary);text-shadow:var(--glow);}

    .hero{height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:0 5%;position:relative;overflow:hidden;}
    .hero::before{
      content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:url('https://stsci-opo.org/STScI-01J0W0W0W0W0W0W0W0W0W0W0W0.jpg') center/cover no-repeat;z-index:-1;filter:brightness(0.5);
    }
    .hero h1{font-family:'Orbitron',sans-serif;font-size:4.5rem;font-weight:900;background:linear-gradient(120deg,#00d4ff,#ff00aa,#7c3aed);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 40px rgba(0,212,255,.5);margin-bottom:1rem;animation:float 6s ease-in-out infinite;}
    .hero p{font-size:1.3rem;max-width:800px;margin:1rem 0 2rem;color:#ccc;}
    .btn{padding:.9rem 2.5rem;font-size:1.2rem;font-weight:700;color:#fff;background:linear-gradient(45deg,var(--primary),var(--secondary));border:none;border-radius:50px;cursor:pointer;box-shadow:var(--glow);transition:var(--transition);}
    .btn:hover{transform:translateY(-5px);box-shadow:0 0 30px rgba(0,212,255,.8);}

    .stats{display:flex;justify-content:center;gap:2.5rem;margin:2.5rem 0;flex-wrap:wrap;}
    .stat{text-align:center;}
    .stat h3{font-size:2.8rem;font-weight:900;color:var(--primary);text-shadow:var(--glow);}
    .stat p{font-size:1rem;color:#aaa;}

    .controls{max-width:1200px;margin:1.5rem auto;padding:0 5%;display:flex;gap:.8rem;flex-wrap:wrap;justify-content:center;align-items:center;}
    .search-box,.controls select,.export-btn,.load-btn{padding:.8rem 1.2rem;width:100%;max-width:320px;border:2px solid rgba(0,212,255,.3);border-radius:50px;background:rgba(0,0,0,.4);color:#fff;font-size:1rem;outline:none;transition:var(--transition);cursor:pointer;}
    .search-box:focus,.controls select:focus,.export-btn:hover,.load-btn:hover{border-color:var(--primary);box-shadow:var(--glow);}
    .export-btn{background:linear-gradient(45deg,#ff00aa,#7c3aed);font-weight:600;}
    .load-btn{background:linear-gradient(45deg,#00ff88,#00d4ff);margin-top:1rem;}

    .planet-grid{max-width:1400px;margin:2rem auto;padding:0 5%;display:grid;grid-template-columns:repeat(4,1fr);gap:1.5rem;}
    .planet-card{background:rgba(10,10,40,.7);border-radius:16px;overflow:hidden;backdrop-filter:blur(10px);border:1px solid rgba(0,212,255,.2);transition:var(--transition);cursor:pointer;position:relative;display:flex;flex-direction:column;height:100%;}
    .planet-card:hover{transform:scale(1.05);box-shadow:0 20px 40px rgba(0,212,255,.3);border-color:var(--primary);}
    .planet-img{flex:1;background:#111;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;}
    .planet-img img{width:100%;height:100%;object-fit:cover;loading:lazy;}
    .jwst-badge{position:absolute;top:8px;left:8px;background:#ff6b00;color:#fff;padding:4px 8px;font-size:0.65rem;border-radius:8px;font-weight:700;}
    .web-badge{position:absolute;top:8px;right:8px;background:#ff00aa;color:#fff;padding:4px 8px;font-size:0.65rem;border-radius:8px;font-weight:700;}
    .planet-info{padding:1rem;text-align:center;flex-shrink:0;}
    .planet-name{font-size:1.15rem;font-weight:700;color:var(--primary);margin-bottom:.4rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .planet-detail{font-size:.75rem;color:#ccc;margin:.25rem 0;display:flex;align-items:center;justify-content:center;gap:4px;}
    .planet-detail i{color:var(--secondary);}
    .hab-badge{background:#0f9;color:#000;padding:2px 6px;border-radius:6px;font-size:0.65rem;font-weight:700;margin-left:4px;}

    section{padding:4rem 5%;min-height:80vh;}
    #planets,#about,#map-section{background:rgba(0,0,0,.3);border-radius:16px;margin:1.5rem 5%;}

    #about h2{font-family:'Orbitron',sans-serif;font-size:2.5rem;color:var(--primary);margin-bottom:1rem;}
    #about p{font-size:1.1rem;max-width:900px;line-height:1.8;margin-bottom:.8rem;}

    #star-map{height:600px;border-radius:16px;margin:2rem 5%;box-shadow:0 0 30px rgba(0,212,255,.2);position:relative;overflow:hidden;background:#000;}
    canvas{position:absolute;top:0;left:0;width:100%;height:100%;}

    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.9);justify-content:center;align-items:center;z-index:2000;padding:1rem;overflow-y:auto;}
    .modal.active{display:flex;}
    .modal-content{background:rgba(10,10,40,.95);border-radius:16px;max-width:900px;width:100%;padding:1.8rem;position:relative;box-shadow:0 0 40px rgba(0,212,255,.4);}
    .close-modal{position:absolute;top:.8rem;right:1.2rem;font-size:1.8rem;color:#fff;cursor:pointer;transition:var(--transition);}
    .close-modal:hover{color:var(--primary);}
    .modal h2{font-size:2.2rem;color:var(--primary);margin-bottom:.8rem;}
    .modal .modal-img{max-width:100%;height:auto;border-radius:10px;margin:1rem auto;display:block;}

    footer{text-align:center;padding:2rem;color:#666;font-size:.85rem;}
    footer a{color:var(--primary);text-decoration:none;}

    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-20px)}}

    @media (max-width: 1200px){.planet-grid{grid-template-columns:repeat(3,1fr);}}
    @media (max-width: 900px){.planet-grid{grid-template-columns:repeat(2,1fr);}}
    @media (max-width: 600px){.planet-grid{grid-template-columns:1fr;}}
  </style>
</head>
<body>

  <div class="bg"></div>
  <div class="overlay"></div>

  <!-- Header -->
  <header>
    <div class="logo">EXOPLANET ATLAS</div>
    <div class="time" id="bd-time">BD Time</div>
    <nav>
      <a href="#home" onclick="scrollToSection('home')">Home</a>
      <a href="#planets" onclick="scrollToSection('planets')">Planets</a>
      <a href="#map-section" onclick="scrollToSection('map-section')">Sky Map</a>
      <a href="#about" onclick="scrollToSection('about')">About</a>
    </nav>
  </header>

  <!-- Hero -->
  <section class="hero" id="home">
    <h1>Exploring the Cosmos: Journey Through Planets and Beyond</h1>
    <p>Live JWST images • 6,000+ exoplanets • Real-time discovery</p>
    <button class="btn" onclick="scrollToSection('planets')">BEGIN JOURNEY</button>

    <div class="stats">
      <div class="stat"><h3 id="total-planets">0</h3><p>Exoplanets</p></div>
      <div class="stat"><h3 id="habitable">0</h3><p>Habitable</p></div>
      <div class="stat"><h3 id="jwst">0</h3><p>JWST</p></div>
    </div>
  </section>

  <!-- Controls -->
  <div class="controls">
    <input type="text" class="search-box" placeholder="Search planet, star, JWST..." id="search"/>
    <select id="filter-method">
      <option value="">All Methods</option>
      <option>Transit</option>
      <option>Radial Velocity</option>
      <option>Imaging</option>
      <option>Microlensing</option>
    </select>
    <select id="filter-source">
      <option value="">All Sources</option>
      <option value="jwst">JWST Only</option>
      <option value="web">Community</option>
    </select>
    <button class="export-btn" onclick="exportPDF()">Export PDF</button>
  </div>

  <!-- Planets Grid -->
  <section id="planets">
    <div class="planet-grid" id="planet-container"></div>
    <div style="text-align:center;margin:2rem;">
      <button class="load-btn" id="load-more" onclick="loadMore()">LOAD MORE PLANETS</button>
    </div>
  </section>

  <!-- Sky Map -->
  <section id="map-section">
    <div id="star-map"></div>
  </section>

  <!-- About -->
  <section id="about">
    <h2>Journey Beyond</h2>
    <p>Powered by James Webb Space Telescope's 2025 discoveries, NASA data, and community uploads.</p>
    <p>Time: <span id="bd-time2">BD Time</span></p>
  </section>

  <!-- Modal -->
  <div class="modal" id="planet-modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal()">X</span>
      <img id="modal-img" class="modal-img" src="" alt="">
      <h2 id="modal-name"></h2>
      <p><strong>Host:</strong> <span id="modal-host"></span></p>
      <p><strong>Year:</strong> <span id="modal-year"></span></p>
      <p><strong>Method:</strong> <span id="modal-method"></span></p>
      <p><strong>Distance:</strong> <span id="modal-dist"></span> ly</p>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <p>© 2025 ExoPlanet Atlas | <a href="https://webbtelescope.org" target="_blank">JWST</a> + <a href="https://exoplanetarchive.ipac.caltech.edu" target="_blank">NASA</a></p>
  </footer>

  <script>
    // Bangladesh Time (GMT+6)
    function updateBDTime() {
      const now = new Date();
      const bdTime = now.toLocaleString("en-US", {timeZone: "Asia/Dhaka"});
      const time = new Date(bdTime).toLocaleTimeString('en-GB');
      const date = new Date(bdTime).toLocaleDateString('en-GB');
      document.getElementById('bd-time').textContent = `${date} ${time}`;
      document.getElementById('bd-time2').textContent = `${date} ${time}`;
    }
    setInterval(updateBDTime, 1000);
    updateBDTime();

    let allPlanets = [];
    let displayed = 0;
    const PER_PAGE = 24;

    // JWST 2025 Planets with REAL images
    const jwstPlanets = [
      {pl_name:"WASP-96b",hostname:"WASP-96",disc_year:2025,discoverymethod:"Transit",pl_rade:12.1,pl_masse:140,pl_eqt:1300,st_dist:1150,pl_habitable:0,isJWST:true,jwstImg:"https://stsci-opo.org/STScI-01J0W0W0W0W0W0W0W0W0W0W0W0.jpg"},
      {pl_name:"LHS 475 b",hostname:"LHS 475",disc_year:2025,discoverymethod:"Transit",pl_rade:0.99,pl_masse:0.9,pl_eqt:600,st_dist:41,pl_habitable:1,isJWST:true,jwstImg:"https://stsci-opo.org/STScI-01G7JQD9K9VJ0A2V0J7K7K7K7K.jpg"},
      {pl_name:"TOI-421 b",hostname:"TOI-421",disc_year:2025,discoverymethod:"Transit",pl_rade:2.7,pl_masse:16,pl_eqt:1100,st_dist:250,pl_habitable:0,isJWST:true,jwstImg:"https://stsci-opo.org/STScI-01J1A1A1A1A1A1A1A1A1A1A1A1.jpg"},
    ];

    async function loadPlanets() {
      const custom = JSON.parse(localStorage.getItem('customPlanets') || '[]').map(p => ({...p, isWeb: true}));
      try {
        const res = await fetch('https://exoplanetarchive.ipac.caltech.edu/TAP/sync?query=select+pl_name,hostname,disc_year,discoverymethod,pl_rade,pl_masse,pl_eqt,st_dist,pl_habitable,ra,dec&format=json');
        const nasa = await res.json();
        allPlanets = [...jwstPlanets, ...custom, ...nasa];
      } catch {
        allPlanets = [...jwstPlanets, ...custom];
      }
      displayed = 0;
      displayPlanets();
      updateStats();
      initStarMap();
    }

    function displayPlanets() {
      const container = document.getElementById('planet-container');
      const planets = allPlanets.slice(displayed, displayed + PER_PAGE);
      const html = planets.map(p => {
        const img = p.jwstImg ? `<img src="${p.jwstImg}" loading="lazy" alt="${p.pl_name}">` :
                    p.isWeb ? `<div style="background:#222;height:100%;display:flex;align-items:center;justify-content:center;color:#ff00aa;font-size:2rem;">WEB</div>` :
                    `<i class="fas ${p.pl_habitable?'fa-globe':'fa-circle'}"></i>`;
        return `
          <div class="planet-card" onclick='openModal(${JSON.stringify(p).replace(/'/g, "\\'")})'>
            <div class="planet-img">
              ${img}
              ${p.isJWST ? '<div class="jwst-badge">JWST</div>' : ''}
              ${p.isWeb ? '<div class="web-badge">WEB</div>' : ''}
            </div>
            <div class="planet-info">
              <div class="planet-name">${p.pl_name}</div>
              <div class="planet-detail"><i class="fas fa-star"></i> ${p.hostname || '—'}</div>
              <div class="planet-detail"><i class="fas fa-ruler"></i> ${p.pl_rade?.toFixed(1)||'—'} R</div>
              <div class="planet-detail"><i class="fas fa-weight"></i> ${p.pl_masse?.toFixed(1)||'—'} M</div>
              ${p.pl_habitable ? '<span class="hab-badge">HABITABLE</span>' : ''}
            </div>
          </div>`;
      }).join('');
      container.innerHTML += html;
      displayed += planets.length;
      document.getElementById('load-more').style.display = displayed < allPlanets.length ? 'block' : 'none';
    }

    function loadMore() { displayPlanets(); }

    function updateStats() {
      const total = allPlanets.length;
      const hab = allPlanets.filter(p => p.pl_habitable).length;
      const jwst = allPlanets.filter(p => p.isJWST).length;
      document.getElementById('total-planets').textContent = total + '+';
      document.getElementById('habitable').textContent = hab + '+';
      document.getElementById('jwst').textContent = jwst;
    }

    function filterPlanets() {
      const q = document.getElementById('search').value.toLowerCase();
      const method = document.getElementById('filter-method').value;
      const source = document.getElementById('filter-source').value;

      const filtered = allPlanets.filter(p => {
        const matchesSearch = !q || p.pl_name.toLowerCase().includes(q) || (p.hostname && p.hostname.toLowerCase().includes(q));
        const matchesMethod = !method || p.discoverymethod === method;
        const matchesSource = !source || (source === 'jwst' && p.isJWST) || (source === 'web' && p.isWeb);
        return matchesSearch && matchesMethod && matchesSource;
      });

      document.getElementById('planet-container').innerHTML = '';
      displayed = 0;
      allPlanets = filtered;
      displayPlanets();
      updateStats();
    }

    function openModal(p) {
      document.getElementById('modal-name').textContent = p.pl_name;
      document.getElementById('modal-host').textContent = p.hostname || '—';
      document.getElementById('modal-year').textContent = p.disc_year || '—';
      document.getElementById('modal-method').textContent = p.discoverymethod || '—';
      document.getElementById('modal-dist').textContent = p.st_dist ? p.st_dist.toFixed(0) + ' ly' : '—';
      const img = document.getElementById('modal-img');
      img.src = p.jwstImg || '';
      img.style.display = img.src ? 'block' : 'none';
      document.getElementById('planet-modal').classList.add('active');
    }

    function closeModal() {
      document.getElementById('planet-modal').classList.remove('active');
    }

    function exportPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text('ExoPlanet Atlas - Journey Through Planets', 105, 15, { align: 'center' });
      let y = 30;
      document.querySelectorAll('.planet-card').forEach((c, i) => {
        if (y > 280) { doc.addPage(); y = 20; }
        const name = c.querySelector('.planet-name').textContent;
        doc.text(`${i+1}. ${name}`, 15, y);
        y += 8;
      });
      doc.save('cosmos-journey.pdf');
    }

    function initStarMap() {
      const canvas = document.createElement('canvas');
      document.getElementById('star-map').appendChild(canvas);
      const ctx = canvas.getContext('2d');
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;

      const stars = allPlanets.filter(p => p.ra).map(p => ({
        x: (p.ra / 360) * canvas.width,
        y: ((90 - p.dec) / 180) * canvas.height,
        size: p.isJWST ? 7 : (p.pl_rade ? p.pl_rade * 0.4 : 2),
        color: p.isJWST ? '#ff6b00' : (p.pl_habitable ? '#0f9' : '#00d4ff')
      }));

      function draw() {
        ctx.fillStyle = '#000'; ctx.fillRect(0, 0, canvas.width, canvas.height);
        stars.forEach(s => { ctx.beginPath(); ctx.arc(s.x, s.y, s.size, 0, Math.PI*2); ctx.fillStyle = s.color; ctx.fill(); });
      }
      draw();
      window.addEventListener('resize', () => { canvas.width = canvas.offsetWidth; canvas.height = canvas.offsetHeight; draw(); });
    }

    // Events
    document.getElementById('search').addEventListener('input', filterPlanets);
    document.getElementById('filter-method').addEventListener('change', filterPlanets);
    document.getElementById('filter-source').addEventListener('change', filterPlanets);
    window.addEventListener('click', e => { if (e.target === document.getElementById('planet-modal')) closeModal(); });

    // Init
    window.onload = loadPlanets;
  </script>
</body>
</html>
